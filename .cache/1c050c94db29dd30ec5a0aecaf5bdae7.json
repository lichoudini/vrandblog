{"dependencies":[{"name":"C:\\Users\\kea_h\\vrandblog\\package.json","includedInParent":true,"mtime":1521988836233},{"name":"C:\\Users\\kea_h\\vrandblog\\.babelrc","includedInParent":true,"mtime":1521988825970},{"name":"C:\\Users\\kea_h\\vrandblog\\node_modules\\browserify-rsa\\package.json","includedInParent":true,"mtime":1521988828091},{"name":"bn.js","loc":{"line":1,"column":17}},{"name":"randombytes","loc":{"line":2,"column":26}},{"name":"buffer"}],"generated":{"js":"var Buffer = require(\"buffer\").Buffer;\nvar bn = require('bn.js');\r\nvar randomBytes = require('randombytes');\r\nmodule.exports = crt;\r\nfunction blind(priv) {\r\n  var r = getr(priv);\r\n  var blinder = r.toRed(bn.mont(priv.modulus))\r\n  .redPow(new bn(priv.publicExponent)).fromRed();\r\n  return {\r\n    blinder: blinder,\r\n    unblinder:r.invm(priv.modulus)\r\n  };\r\n}\r\nfunction crt(msg, priv) {\r\n  var blinds = blind(priv);\r\n  var len = priv.modulus.byteLength();\r\n  var mod = bn.mont(priv.modulus);\r\n  var blinded = new bn(msg).mul(blinds.blinder).umod(priv.modulus);\r\n  var c1 = blinded.toRed(bn.mont(priv.prime1));\r\n  var c2 = blinded.toRed(bn.mont(priv.prime2));\r\n  var qinv = priv.coefficient;\r\n  var p = priv.prime1;\r\n  var q = priv.prime2;\r\n  var m1 = c1.redPow(priv.exponent1);\r\n  var m2 = c2.redPow(priv.exponent2);\r\n  m1 = m1.fromRed();\r\n  m2 = m2.fromRed();\r\n  var h = m1.isub(m2).imul(qinv).umod(p);\r\n  h.imul(q);\r\n  m2.iadd(h);\r\n  return new Buffer(m2.imul(blinds.unblinder).umod(priv.modulus).toArray(false, len));\r\n}\r\ncrt.getr = getr;\r\nfunction getr(priv) {\r\n  var len = priv.modulus.byteLength();\r\n  var r = new bn(randomBytes(len));\r\n  while (r.cmp(priv.modulus) >=  0 || !r.umod(priv.prime1) || !r.umod(priv.prime2)) {\r\n    r = new bn(randomBytes(len));\r\n  }\r\n  return r;\r\n}\r\n","map":{"mappings":[{"source":"node_modules\\browserify-rsa\\index.js","original":{"line":1,"column":0},"generated":{"line":2,"column":0}},{"source":"node_modules\\browserify-rsa\\index.js","original":{"line":2,"column":0},"generated":{"line":3,"column":0}},{"source":"node_modules\\browserify-rsa\\index.js","original":{"line":3,"column":0},"generated":{"line":4,"column":0}},{"source":"node_modules\\browserify-rsa\\index.js","original":{"line":4,"column":0},"generated":{"line":5,"column":0}},{"source":"node_modules\\browserify-rsa\\index.js","original":{"line":5,"column":0},"generated":{"line":6,"column":0}},{"source":"node_modules\\browserify-rsa\\index.js","original":{"line":6,"column":0},"generated":{"line":7,"column":0}},{"source":"node_modules\\browserify-rsa\\index.js","original":{"line":7,"column":0},"generated":{"line":8,"column":0}},{"source":"node_modules\\browserify-rsa\\index.js","original":{"line":8,"column":0},"generated":{"line":9,"column":0}},{"source":"node_modules\\browserify-rsa\\index.js","original":{"line":9,"column":0},"generated":{"line":10,"column":0}},{"source":"node_modules\\browserify-rsa\\index.js","original":{"line":10,"column":0},"generated":{"line":11,"column":0}},{"source":"node_modules\\browserify-rsa\\index.js","original":{"line":11,"column":0},"generated":{"line":12,"column":0}},{"source":"node_modules\\browserify-rsa\\index.js","original":{"line":12,"column":0},"generated":{"line":13,"column":0}},{"source":"node_modules\\browserify-rsa\\index.js","original":{"line":13,"column":0},"generated":{"line":14,"column":0}},{"source":"node_modules\\browserify-rsa\\index.js","original":{"line":14,"column":0},"generated":{"line":15,"column":0}},{"source":"node_modules\\browserify-rsa\\index.js","original":{"line":15,"column":0},"generated":{"line":16,"column":0}},{"source":"node_modules\\browserify-rsa\\index.js","original":{"line":16,"column":0},"generated":{"line":17,"column":0}},{"source":"node_modules\\browserify-rsa\\index.js","original":{"line":17,"column":0},"generated":{"line":18,"column":0}},{"source":"node_modules\\browserify-rsa\\index.js","original":{"line":18,"column":0},"generated":{"line":19,"column":0}},{"source":"node_modules\\browserify-rsa\\index.js","original":{"line":19,"column":0},"generated":{"line":20,"column":0}},{"source":"node_modules\\browserify-rsa\\index.js","original":{"line":20,"column":0},"generated":{"line":21,"column":0}},{"source":"node_modules\\browserify-rsa\\index.js","original":{"line":21,"column":0},"generated":{"line":22,"column":0}},{"source":"node_modules\\browserify-rsa\\index.js","original":{"line":22,"column":0},"generated":{"line":23,"column":0}},{"source":"node_modules\\browserify-rsa\\index.js","original":{"line":23,"column":0},"generated":{"line":24,"column":0}},{"source":"node_modules\\browserify-rsa\\index.js","original":{"line":24,"column":0},"generated":{"line":25,"column":0}},{"source":"node_modules\\browserify-rsa\\index.js","original":{"line":25,"column":0},"generated":{"line":26,"column":0}},{"source":"node_modules\\browserify-rsa\\index.js","original":{"line":26,"column":0},"generated":{"line":27,"column":0}},{"source":"node_modules\\browserify-rsa\\index.js","original":{"line":27,"column":0},"generated":{"line":28,"column":0}},{"source":"node_modules\\browserify-rsa\\index.js","original":{"line":28,"column":0},"generated":{"line":29,"column":0}},{"source":"node_modules\\browserify-rsa\\index.js","original":{"line":29,"column":0},"generated":{"line":30,"column":0}},{"source":"node_modules\\browserify-rsa\\index.js","original":{"line":30,"column":0},"generated":{"line":31,"column":0}},{"source":"node_modules\\browserify-rsa\\index.js","original":{"line":31,"column":0},"generated":{"line":32,"column":0}},{"source":"node_modules\\browserify-rsa\\index.js","original":{"line":32,"column":0},"generated":{"line":33,"column":0}},{"source":"node_modules\\browserify-rsa\\index.js","original":{"line":33,"column":0},"generated":{"line":34,"column":0}},{"source":"node_modules\\browserify-rsa\\index.js","original":{"line":34,"column":0},"generated":{"line":35,"column":0}},{"source":"node_modules\\browserify-rsa\\index.js","original":{"line":35,"column":0},"generated":{"line":36,"column":0}},{"source":"node_modules\\browserify-rsa\\index.js","original":{"line":36,"column":0},"generated":{"line":37,"column":0}},{"source":"node_modules\\browserify-rsa\\index.js","original":{"line":37,"column":0},"generated":{"line":38,"column":0}},{"source":"node_modules\\browserify-rsa\\index.js","original":{"line":38,"column":0},"generated":{"line":39,"column":0}},{"source":"node_modules\\browserify-rsa\\index.js","original":{"line":39,"column":0},"generated":{"line":40,"column":0}},{"source":"node_modules\\browserify-rsa\\index.js","original":{"line":40,"column":0},"generated":{"line":41,"column":0}},{"source":"node_modules\\browserify-rsa\\index.js","original":{"line":41,"column":0},"generated":{"line":42,"column":0}}],"sources":{"node_modules\\browserify-rsa\\index.js":"var bn = require('bn.js');\r\nvar randomBytes = require('randombytes');\r\nmodule.exports = crt;\r\nfunction blind(priv) {\r\n  var r = getr(priv);\r\n  var blinder = r.toRed(bn.mont(priv.modulus))\r\n  .redPow(new bn(priv.publicExponent)).fromRed();\r\n  return {\r\n    blinder: blinder,\r\n    unblinder:r.invm(priv.modulus)\r\n  };\r\n}\r\nfunction crt(msg, priv) {\r\n  var blinds = blind(priv);\r\n  var len = priv.modulus.byteLength();\r\n  var mod = bn.mont(priv.modulus);\r\n  var blinded = new bn(msg).mul(blinds.blinder).umod(priv.modulus);\r\n  var c1 = blinded.toRed(bn.mont(priv.prime1));\r\n  var c2 = blinded.toRed(bn.mont(priv.prime2));\r\n  var qinv = priv.coefficient;\r\n  var p = priv.prime1;\r\n  var q = priv.prime2;\r\n  var m1 = c1.redPow(priv.exponent1);\r\n  var m2 = c2.redPow(priv.exponent2);\r\n  m1 = m1.fromRed();\r\n  m2 = m2.fromRed();\r\n  var h = m1.isub(m2).imul(qinv).umod(p);\r\n  h.imul(q);\r\n  m2.iadd(h);\r\n  return new Buffer(m2.imul(blinds.unblinder).umod(priv.modulus).toArray(false, len));\r\n}\r\ncrt.getr = getr;\r\nfunction getr(priv) {\r\n  var len = priv.modulus.byteLength();\r\n  var r = new bn(randomBytes(len));\r\n  while (r.cmp(priv.modulus) >=  0 || !r.umod(priv.prime1) || !r.umod(priv.prime2)) {\r\n    r = new bn(randomBytes(len));\r\n  }\r\n  return r;\r\n}\r\n"},"lineCount":42}},"hash":"74e841f976b082367c9e701fcd25cdca","cacheData":{"env":{}}}